{
    "version": "0.4",
    "homepage": "https://github.com/SaifAqqad/AHK_MicMute",
    "checkver": "github",
    "url": "https://github.com/SaifAqqad/AHK_MicMute/releases/download/v0.4/MicMute.exe",
    "hash": "6F3E2F622A9C0928A383699AF85DDCA3AA96B1CA971692FAB2BF14F41FAA10D3",
    "pre_install": [
        "$MicMuteProc = Get-Process -name MicMute -ErrorAction \"Ignore\"",
        "if ($MicMuteProc -ne $null) {",
        "Stop-Process -Name MicMute",
        "}",
        "function ensureFile([String] $name) {",
        "    if (!(Test-Path \"$persist_dir\\$name\") -and !(Test-Path \"$dir\\$name\")) {",
        "        Add-Content -Path \"$dir\\$name\" -Value $null",
        "    }",
        "}",
        "ensureFile 'config.ini'"
    ],
    "persist": [
        "config.ini"
    ],
    "post_install": [
        "$WshShell = New-Object -comObject WScript.Shell",
        "$Shortcut = $WshShell.CreateShortcut(\"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MicMute.lnk\")",
        "$Shortcut.TargetPath = \"$dir\\MicMute.exe\"",
        "$Shortcut.WorkingDirectory  = \"$dir\\\"",
        "$Shortcut.Save()"
    ],
    "uninstaller": {
        "script": [
            "$FileName = \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MicMute.lnk\"",
            "if (Test-Path $FileName) ",
            "{",
            " Remove-Item $FileName",
            "}"
        ]
    },
    "shortcuts": [
        [
            "MicMute.exe",
            "SaifAqqad/MicMute"
        ]
    ]
}
